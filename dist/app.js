!function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=e(function(e){!function(t){var n=function(){},o=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(t){return setTimeout(t,16)};function i(){this.reads=[],this.writes=[],this.raf=o.bind(t)}function r(t){t.scheduled||(t.scheduled=!0,t.raf(function(t){var e,o=t.writes,i=t.reads;try{n("flushing reads",i.length),a(i),n("flushing writes",o.length),a(o)}catch(t){e=t}t.scheduled=!1,(i.length||o.length)&&r(t);if(e){if(n("task errored",e.message),!t.catch)throw e;t.catch(e)}}.bind(null,t)))}function a(t){for(var e;e=t.shift();)e()}function s(t,e){var n=t.indexOf(e);return!!~n&&!!t.splice(n,1)}i.prototype={constructor:i,measure:function(t,e){var n=e?t.bind(e):t;return this.reads.push(n),r(this),n},mutate:function(t,e){var n=e?t.bind(e):t;return this.writes.push(n),r(this),n},clear:function(t){return s(this.reads,t)||s(this.writes,t)},extend:function(t){if("object"!=typeof t)throw new Error("expected object");var e=Object.create(this);return function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}(e,t),e.fastdom=this,e.initialize&&e.initialize(),e},catch:null};var c=t.fastdom=t.fastdom||new i;e.exports=c}("undefined"!=typeof window?window:t)}),o=e(function(t){!function(){var e={initialize:function(){this._tasks=new Map},mutate:function(t,e){return n(this,"mutate",t,e)},measure:function(t,e){return n(this,"measure",t,e)},clear:function(t){var e=this._tasks,n=e.get(t);this.fastdom.clear(n),e.delete(t)}};function n(t,e,n,o){var i,r=t._tasks,a=t.fastdom,s=new Promise(function(t,c){i=a[e](function(){r.delete(s);try{t(o?n.call(o):n())}catch(t){c(t)}},o)});return r.set(s,i),s}"f"=="undefined"[0]?(void 0)(function(){return e}):"o"=="object"[0]?t.exports=e:window.fastdomPromised=e}()});const i=(t,e)=>{const n=`__${e}`;let o=t.target;for(;null!==o;){const e=o[n];if(e)return void e(t);o=o.parentNode}},r={};function a(t){r[t]||(document.addEventListener(t,e=>i(e,t)),r[t]=!0)}const s=(t,e,n="s")=>`${t} ${e}${1!==t?n:""}`,c=(t,e)=>t.classList.add(e);function l(t,e){for(let n=0,o=t.length;n<o&&!e(t[n],n,t);n++);return t}const d=new Map,u={set:(t,e)=>{d.set(t,e)},get:t=>d.has(t)?d.get(t):JSON.stringify({}),delete:t=>d.delete(t)};function p(t){const{client_id:e,client_secret:n,storage:o,...i}=t;this.client_id=e,this.client_secret=n||void 0,this.storage=o||u,this.fetch=t.fetch?t.fetch:fetch,this.options={host:t.host?t.host:"api.moltin.com",version:t.version?t.version:"v2",...i}}let f,h,m;function g(t,e){f.debounce&&void 0!==h&&h.abort(),AbortController&&(h=new AbortController,m=h.signal);const{body:n,method:o,headers:i}=e;return fetch(t,{signal:m,method:o,headers:i,body:n})}function b(t){if(3!==t.nodeType){if(void 0!==t.attributes)for(let e of Array.from(t.attributes)){let n=e.name;if("#"===n[0])return t.removeAttribute(n),n.slice(1)}return 0}{let e=t.nodeValue;return"#"===e[0]?(t.nodeValue="",e.slice(1)):0}}p.prototype.authenticate=async function(){const{client_id:t,client_secret:e,storage:n,options:{host:o}}=this;if(!t)throw new Error("You must provide a client_id");const i=`https://${o}/oauth/access_token`,r={grant_type:e?"client_credentials":"implicit",client_id:t,...e&&{client_secret:e}},a=await this.fetch(i,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-MOLTIN-SDK-LANGUAGE":"JS-REQUEST"},body:Object.keys(r).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(r[t])}`).join("&")}),{access_token:s,expires:c}=await a.json();if(!s)throw new Error("Unable to obtain an access token");if(n){const e={client_id:t,access_token:s,expires:c};await n.set("moltinCredentials",JSON.stringify(e))}return s},p.prototype.request=async function(t,e,n,o){const{client_id:i,storage:r,options:{application:a,currency:s,customer_token:c,host:l,version:d,headers:u}}=this,p=`https://${l}/${d}/${f=e,f.replace(/^\/+/,"")}`;var f;const h={...u,...o};let m,g;r&&(m=await JSON.parse(r.get("moltinCredentials")));const b={"Content-Type":"application/json","X-MOLTIN-SDK-LANGUAGE":"JS-REQUEST",Authorization:`Bearer ${g=!m||!m.access_token||m.client_id!==i||Math.floor(Date.now()/1e3)>=m.expires?await this.authenticate():m.access_token}`,...a&&{"X-MOLTIN-APPLICATION":a},...s&&{"X-MOLTIN-CURRENCY":s},...c&&{"X-MOLTIN-CUSTOMER-TOKEN":c},...h},y=h["Content-Type"]?n:{body:JSON.stringify({data:n})},x=await this.fetch(p,{method:t,headers:b,...n&&y});if(204===x.status)return x.text();const w=await x.json();if(!x.ok)throw{statusCode:x.status,...w};return w},p.prototype.get=function(t,e){return this.request("GET",t,void 0,e)},p.prototype.put=function(t,e,n){return this.request("PUT",t,e,n)},p.prototype.post=function(t,e,n){return this.request("POST",t,e,n)},p.prototype.delete=function(t,e,n){return this.request("DELETE",t,e,n)};const y=document.createTreeWalker(document,NodeFilter.SHOW_ALL,null,!1);y.roll=function(t){for(;--t;)this.nextNode();return this.currentNode};class x{constructor(t,e){this.idx=t,this.ref=e}}function w(t){const e={},n=y;return n.currentNode=t,this._refPaths.map(t=>e[t.ref]=n.roll(t.idx)),e}function v(t){t._refPaths=function(t){const e=y;e.currentNode=t;let n,o=[],i=0;do{(n=b(t))?(o.push(new x(i+1,n)),i=1):i++}while(t=e.nextNode());return o}(t),t.collect=w}const C=document.createElement("template");function k(t,...e){const n=String.raw(t,...e).replace(/>\n+/g,">").replace(/\s+</g,"<").replace(/>\s+/g,">").replace(/\n\s+/g,"\x3c!-- --\x3e");C.innerHTML=n;const o=C.content.firstChild;return v(o),o}var T=function(t){var e={},n={},o=function(t,i){if("@dispatch"!==t&&o("@dispatch",[t,i,e[t]]),e[t]){var r,a={};e[t].forEach(function(t){var e=t(n,i);e&&"function"!=typeof e.then&&(r=Object.assign({},n,e),Object.assign(a,e),n=r)}),r&&o("@changed",a)}},i={dispatch:o,get:function(){return n},on:function(t,n){return(e[t]||(e[t]=[])).push(n),function(){e[t]=e[t].filter(function(t){return t!==n})}}};return t.forEach(function(t){t&&t(i)}),o("@init"),i},_=function(t,e){t=t||[];var n=(e=e||{}).key||"storeon";return function(e){e.on("@init",function(){try{var t=localStorage.getItem(n);if(null!==t)return JSON.parse(t)}catch(t){}}),e.on("@dispatch",function(e,o){if("@init"!==o[0]){var i={};0===t.length?i=e:t.forEach(function(t){i[t]=e[t]});try{var r=JSON.stringify(i);localStorage.setItem(n,r)}catch(t){}}})}};const S=(E=E||Object.create(null),{on:function(t,e){(E[t]||(E[t]=[])).push(e)},off:function(t,e){E[t]&&E[t].splice(E[t].indexOf(e)>>>0,1)},emit:function(t,e){(E[t]||[]).slice().map(function(t){t(e)}),(E["*"]||[]).slice().map(function(n){n(t,e)})}});var E;const O=T([t=>{t.on("@init",()=>({cart:{id:"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[x]/g,()=>(16*Math.random()|0).toString(16)),meta:null,items:[],loading:!0}})),t.on("@changed",({cart:t})=>{t.loading=!1,t.isEmpty=0===t.items.length,t.count=t.items.reduce((t,{quantity:e})=>t+e,0),t.subTotal=t.meta?t.meta.display_price.without_tax.formatted:0,t.items=t.items.filter(({type:t})=>"cart_item"===t||"custom_item"===t),t.promotionItems=t.items.filter(({type:t})=>"promotion_item"===t),t.taxItems=t.items.filter(({type:t})=>"tax_item"===t),t.averageApiRequest=function(t){if(!performance)return null;const e=performance.getEntriesByType("resource"),n=[];for(const o in e){const i=e[o];i.name.includes(t)&&n.push(Math.ceil(i.duration))}return n.length?n.reduce((t,e)=>t+e,0)/n.length:null}("https://api.moltin.com")}),t.on("setId",({cart:t},e)=>t.id=e),t.on("setCart",({cart:t},{data:e,meta:n})=>({cart:{...t,items:e,meta:n}})),t.on("getCart",async e=>{const n=await f.get(`carts/${e.cart.id}/items`);t.dispatch("setCart",n)}),t.on("deleteCart",async e=>{await f.delete(`carts/${e.cart.id}`),t.dispatch("setCart",{data:[],meta:null,error:null})}),t.on("addItem",async(e,{quantity:n=1,type:o="cart_item",...i})=>{const r=await f.post(`carts/${e.cart.id}/items`,{type:o,quantity:n,...i});t.dispatch("setCart",r)}),t.on("updateItem",async(e,n)=>{const{id:o,quantity:i}=n,{id:r}=e.cart;try{f.debounce=!0;const e=await f.put(`carts/${r}/items/${o}`,{type:"cart_item",itemId:o,quantity:i});f.debounce=!1,t.dispatch("setCart",e)}catch(t){console.log(t)}}),t.on("removeItem",async(e,n)=>{const{id:o}=e.cart,i=await f.delete(`carts/${o}/items/${n}`);t.dispatch("setCart",i)}),t.on("addPromotion",async(e,n)=>{const{id:o}=e.cart;try{const e=await f.post(`carts/${o}/items`,{type:"promotion_item",promotionCode:n});t.dispatch("setCart",e)}catch({statusCode:t}){console.log("Code expired or invalid")}finally{return{state:{cart:{error:"error"}}}}})},t=>{t.on("@init",()=>({modal:{route:"cart",open:!1}})),t.on("@changed",({modal:t})=>{t.checkingOut=["shipping","billing"].includes(t.route)}),t.on("changeRoute",({modal:t},e)=>({modal:{route:e,open:!0}})),t.on("goToCart",()=>t.dispatch("changeRoute","cart")),t.on("goToShipping",()=>t.dispatch("changeRoute","shipping")),t.on("goToBilling",()=>t.dispatch("changeRoute","billing")),t.on("goToOrders",()=>t.dispatch("changeRoute","orders")),t.on("goToLogin",()=>t.dispatch("changeRoute","login")),t.on("goToConfirmation",()=>t.dispatch("changeRoute","confirmation")),t.on("toggle",({modal:t})=>t.open=!t.open),t.on("openCart",({modal:t})=>({modal:{open:!0,route:"cart"}})),t.on("closeModal",e=>{const{checkingOut:n}=e.modal,{completed:o}=e.checkout;!o&&n||t.dispatch("close")}),t.on("close",({modal:t})=>({modal:{open:!1}})),t.on("continueShopping",({modal:t})=>({modal:{open:!1,route:"cart"}}))},t=>{t.on("@init",()=>({checkout:{route:"shipping",dirty:!1,completed:!1}}))},function(t){t.on("@changed",function(t){Object.keys(t).forEach(e=>{S.emit(e,t[e])})})},_(["cart"],{key:"mcart"})]);function I(){const{possible:t,n:e}=I;let n,o=e.toString(26).split(""),i="";for(;n=o.shift();)i+=t[parseInt(n,26)];return I.n++,i}I.possible="abcdefghijklmnopqrstuvwxyz",I.n=0;let N=document.createElement("style");function $(t){for(let e in t){const n=`${e}-${I()}`,o=N.insertRule(`.${n} {}`,N.cssRules.length),i=N.cssRules[o].style,r=t[e];for(let t in r)if(":"===t[0]||" "===t[0]){const e=N.insertRule(`.${n}${t} {}`,N.cssRules.length),o=N.cssRules[e].style;Object.assign(o,r[t]),delete r[t]}Object.assign(i,r),t[e]=n}return t}N.id="stage0",document.head.appendChild(N),N=N.sheet;const R="#177EE6",q="#273142",j="#fff",A="#58697F",P="0.875rem",M=k`
  <img src="spinner.svg" class=${$({base:{display:"inline","margin-right":"0.25rem"}}).base} alt="Loading" />
`,z=$({base:{background:"none","box-sizing":"border-box","line-height":"1.15","-webkit-text-size-adjust":"100%",margin:0,"font-family":"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif","font-size":"15px",appearance:"none","border-radius":"0.25rem",border:"1px solid transparent","font-weight":500,outline:"none",padding:"0 1rem",opacity:1,color:A,"::before, ::after":{"box-sizing":"inherit","-webkit-font-smoothing":"antialiased"},":hover, :focus":{outline:"none"},":hover":{cursor:"pointer"}},primary:{"background-color":R,"border-color":j,color:j,height:"2.8rem",display:"inline-flex","align-items":"center","justify-content":"center"},text:{color:q,"font-weight":500,"font-size":`${P} !important`,"text-decoration":"underline",padding:0,":hover":{color:R}},noPadding:{padding:0},disabled:{opacity:.5,":hover":{cursor:"not-allowed"}},block:{width:"100%"},marginTop:{"margin-top":"1.5rem"},large:{height:"3.25rem"}}),L=k`
  <button class="${z.base}">#text</button>
`;function U(t={}){const{text:e,type:n,block:o,large:i,loading:r,disabled:a,marginTop:s,noPadding:l}=t,d=L,u=L.collect(d).text;return d.update=t=>u.nodeValue=t,d.update(e),l&&c(d,l),n&&c(d,z[n]),o&&c(d,z.block),i&&c(d,z.large),a&&c(d,z.disabled),s&&c(d,z.marginTop),r?M:d}const B=k`
  <span class="shopkit-buy-button"></span>
`;function F(t){const{moltinText:e,moltinType:n,moltinProductId:o}=t;if("custom"!==n&&!o)return console.warn("No product ID provided to Moltin Btn."),null;B.appendChild(U({text:e||"Add to Cart",type:"primary"}));const i=B.cloneNode(!0);return i.__click=()=>(function(t){"custom"!==t.moltinType?O.dispatch("addItem",{id:t.moltinProductId}):O.dispatch("addItem",{type:"custom_item",name:t.moltinProductName,sku:t.moltinProductSku,price:{amount:parseInt(t.moltinProductPrice,10)}}),t.moltinOpenCart&&O.dispatch("goToCart")})(t),i}const J=k`
  <span class="shopkit-cart-button"></span>
`;function X(t){const{moltinText:e,moltinShowTotal:n}=t;let{count:o,subTotal:i}=O.get().cart;const r=J;const a=()=>`${e||"Cart"}${(i||o?` (${n?i:s(o,"item")})`:null)||""}`,c=U({text:a(),type:"primary"});return r.appendChild(c),r.update=t=>{({count:o,subTotal:i}=t),c.update(a())},S.on("cart",t=>r.update(t)),r.__click=()=>O.dispatch("getCart"),r}const D=n.extend(o);function initialize(t){let e,n,o,i,r,s,c;D.measure(()=>{e=t.querySelector("script[data-moltin-client-id]")}).then(()=>{e?(({moltinClientId:o,moltinStripePublishableKey:i,moltinCurrency:r}=e.dataset),i?function(t){(f=t).debounce=!1}(n=new p({fetch:g,client_id:o,application:"moltin-btn",...r&&{moltinCurrency:r}})):console.error("You must provide your Stripe Publishable Key to enable the Moltin Btn")):console.error("You must provide a Moltin Client ID to enable the Moltin Btn")}),D.measure(()=>{s=[...t.getElementsByClassName("moltin-buy-button")]}).then(()=>{l(s,t=>{D.mutate(()=>t.appendChild(F({...t.dataset})))})}),D.measure(()=>{c=[...t.getElementsByClassName("moltin-cart-button")]}).then(()=>{l(c,t=>{D.mutate(()=>t.appendChild(X({loading:!0,...t.dataset})))})}),a("click")}document.onreadystatechange=()=>{"complete"===document.readyState&&initialize(document)},K.notEqual=function(t,e,n){K(t!=e,n)},K.notOk=function(t,e){K(!t,e)},K.equal=function(t,e,n){K(t==e,n)},K.ok=K;var G=K;function K(t,e){if(!t)throw new Error(e||"AssertionError")}var H={},Y="undefined"!=typeof window,V=Y&&window.requestIdleCallback,Q=function t(e,n){n=n||H;var o;G.equal(typeof e,"function","on-idle: cb should be type function");G.equal(typeof n,"object","on-idle: opts should be type object");if(V)return o=window.requestIdleCallback(function(o){if(o.timeRemaining()<=1&&!o.didTimeout)return t(e,n);e(o)},n),window.cancelIdleCallback.bind(window,o);if(Y)return o=setTimeout(e,0),clearTimeout.bind(window,o)};const W=$({base:{transition:"all 0.3s ease","background-color":"#fff",position:"fixed",top:0,bottom:0,right:0,"overflow-y":scroll,height:"100%","box-shadow":"0 25px 50px -12px rgba(0, 0, 0, 0.25)","z-index":1000000001,padding:"1.5rem",width:"100%","border-width":0,"max-width":"500px",display:"flex","flex-direction":"column","justify-content":"space-between","box-sizing":"border-box","line-height":1.15,"-webkit-text-size-adjust":"100%",margin:0,"font-family":"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif","font-size":"15px","*, *::before, *::after":{"box-sizing":"inherit","-webkit-font-smoothing":"antialiased"}},hidden:{opacity:0,visibility:"hidden",transform:"translateX(0)"},visible:{opacity:1,visibility:"visible",transform:"translateX(525px)"}}),Z=k`
  <div class="shopkit-modal-overlay ${$({base:{transition:"all 0.3s ease","background-color":"#333",position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":1e9},hidden:{opacity:0,visibility:"hidden","overflow-x":0},visible:{opacity:1,visibility:"visible","overflow-x":100}}).hidden}"></div>
`,tt=k`
  <div class="shopkit-modal"></div>
`;let et;function initializeCart(){et();const t=function(t={}){const{open:e}=t,n=tt,o=Z;return n.appendChild(o),c(n,W.base),e||c(n,W.hidden),n}(),e=document.createElement("div");e.appendChild(t),document.body.appendChild(e)}window.onload=()=>{et=Q(()=>initializeCart())}}();
